# NHPflex2025

**Project:** Flexible electrode systems for non-human primates (NHPs)

This repository accompanies a bioRxiv preprint describing the design, fabrication, and use of flexible neural probes and associated hardware for chronic recordings in non-human primates. It contains all files needed to reproduce the figures in the manuscript, design and fabrication data for probes and PCBs, 3D designs for a microdrive adapter, and the analysis code used in the study.

**Repository Contents**
- **`/data/neurons/`**: Neuron spike files (processed and raw spike-sorted outputs).
- **`/data/drift/`**: Drift measurements and calibration data used in analyses.
- **`/data/raw/fig1-5/`**: Raw and preprocessed datasets used to generate Figures 1–5.
- **`/data/raw/supp_fig1-5/`**: Raw datasets used to generate Supplementary Figures 1–5.
- **`/probes/`**: Probe fabrication files, masks, and CAD used for probe layout.
- **`/pcb/`**: PCB design files and Gerbers for electronics supporting the probes.
- **`/fabrication/`**: Link and step-by-step notes for the probe fabrication process (see `README` inside folder).
- **`/3d/`**: 3D design files (STEP, STL) for the microdrive adapter and mounting parts.
- **`/code/`**: All analysis code used in the manuscript. Subfolders include `figures/` with scripts to reproduce each figure.
- **`/figures/`**: Reconstructed figure images generated by the analysis scripts.
- **`/docs/`**: Additional documentation, protocol notes, and ethical approvals metadata (redacted as necessary).

**How to Use This Repository**
- Reproduce figures: each figure (1–5) has a dedicated script under `code/figures/fig1` ... `code/figures/fig5`. Run the corresponding `run_figureX.sh` or `figureX.ipynb` to reproduce the figure panels.
- Example (shell):

```
cd code/figures/fig1
bash run_figure1.sh
```

- For reproducibility we provide environment files: `requirements.txt` (Python) and `environment.yml` (conda). Create an environment before running the analysis.

```
conda env create -f environment.yml
conda activate nhpflex
pip install -r requirements.txt
```

**Probe Fabrication & PCB**
- The `probes/` directory contains CAD, mask layouts, and fabrication notes. The `pcb/` directory contains the PCB schematics, KiCad project files, and Gerber exports.
- Fabrication process (detailed steps and external resources) are in `fabrication/README.md`. For the fabrication service used in this work, see: [Probe fabrication process & vendor link](https://example-probe-fab.example.com) (replace with actual link when available).

**3D Designs**
- The `3d/` folder includes STEP and STL files for the microdrive adapter used to mount flexible probes. CAD source (SolidWorks/FreeCAD) files are included where licensing permits.

**Data Availability & Ethical Considerations**
- Raw and processed data used to generate manuscript figures are provided under `data/` with clear README files describing formats and provenance.
- Some NHP data may contain sensitive metadata; files that require access control are flagged and the repository includes instructions for requesting access. All experiments were performed according to institutional animal care and use committee (IACUC) approvals — see `docs/ethics.md` for details.

**Reproducing Figures (summary)**
- Each figure folder includes a `README.md` describing inputs, preprocessing steps, and the exact command(s) to run.
- Typical workflow to reproduce a figure:
	- Prepare environment (see `environment.yml`).
	- Download or point to required data in `data/raw/`.
	- Run the `run_figureX.sh` script which sequentially performs preprocessing, analysis, and plotting.

**Code Organization**
- `code/processing/`: preprocessing and spike-sorting wrappers.
- `code/analysis/`: core analysis routines used across figures.
- `code/figures/`: figure-specific pipelines, notebooks, and helper scripts.
- `code/utils/`: utility scripts for file I/O, plotting styles, and reproducible seeds.

**Citation**
When using these data or code, please cite the accompanying preprint:

Author(s). Title. bioRxiv (Year). DOI/URL

Example citation (replace with actual):
Gonzales Lab et al., Flexible electrodes for chronic NHP recordings, bioRxiv, 2025. https://doi.org/xxxx

**License**
- Code and designs are provided under the repository license (see `LICENSE`). If no license is present, contact the authors before reuse.

**Contributing & Contact**
- Contributions and corrections welcome. Please open an issue or submit a pull request.
- Contact lead author: `lead.author@example.edu` (replace with real contact)

**Acknowledgements**
- List funding sources, collaborators, and fabrication partners in `ACKNOWLEDGEMENTS.md`.

---
If you want, I can also scaffold the folder structure and add minimal example files and run scripts. Would you like me to create that now?